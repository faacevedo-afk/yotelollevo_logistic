@model yotelollevo.ViewModels.AsignarPaquetesVM

@{
    ViewBag.Title = "Asignar";
}

<h2>Asignar paquetes</h2>
<p class="text-muted">@Model.RutaInfo</p>

@using (Html.BeginForm("Asignar", "Rutas", FormMethod.Post))
{
    @Html.AntiForgeryToken()
    @Html.HiddenFor(m => m.IdRuta)

    <h3>Pendientes</h3>

    if (Model.Pendientes == null || !Model.Pendientes.Any())
    {
        <div class="alert alert-warning">
            No hay paquetes pendientes (estado <strong>Creado</strong>) para asignar.
        </div>
    }
    else
    {
        <table class="table table-striped">
            <thead>
                <tr>
                    <th></th>
                    <th>Tienda</th>
                    <th>Destinatario</th>
                    <th>Dirección</th>
                    <th>Comuna</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var p in Model.Pendientes)
                {
                    <tr>
                        <td>
                            <input type="checkbox" name="PaquetesSeleccionados" value="@p.IdPaquete" />
                        </td>
                        <td>@p.Tienda</td>
                        <td>@p.Destinatario</td>
                        <td>@p.Direccion</td>
                        <td>@p.Comuna</td>
                    </tr>
                }
            </tbody>
        </table>
    }

    <div class="d-flex gap-2">
        <a class="btn btn-secondary" href="@Url.Action("Index", "Rutas")">← Volver</a>
        <button type="submit" class="btn btn-primary">Guardar asignación</button>
    </div>
}

<hr />

<h3>Ya asignados en esta ruta</h3>

@if (Model.YaEnRuta == null || !Model.YaEnRuta.Any())
{
    <div class="alert alert-info">
        Aún no hay paquetes asignados a esta ruta.
    </div>
}
else
{
    <table class="table table-bordered">
        <thead>
            <tr>
                <th>Orden</th>
                <th>IdPaquete</th>
                <th>Tienda</th>
                <th>Destinatario</th>
                <th>Dirección</th>
                <th>Comuna</th>
            </tr>
        </thead>
        <tbody>
            @{
                int orden = 0;
            }
            @foreach (var p in Model.YaEnRuta)
            {
                orden++;
                <tr>
                    <td>@orden</td>
                    <td>@p.IdPaquete</td>
                    <td>@p.Tienda</td>
                    <td>@p.Destinatario</td>
                    <td>@p.Direccion</td>
                    <td>@p.Comuna</td>
                </tr>
            }
        </tbody>
    </table>
}
